/**
 * 
 * MemberMouse(TM) (http://www.membermouse.com)
 * (c) MemberMouse, LLC. All rights reserved.
 */
class MM_SupportUtils
{
	public static function hasEmailSupport()
	{
		if(MM_MemberMouseService::hasPermission(MM_MemberMouseService::$SUPPORT_EMAIL))
		{
			return true;
		}
		return false;
	}
	
	public static function hasPhoneSupport()
	{
		if(MM_MemberMouseService::hasPermission(MM_MemberMouseService::$SUPPORT_PHONE))
		{
			return true;
		}
		return false;
	}
	
	public static function getSupportPin()
	{
		$pin = "";
		
		if(self::hasPhoneSupport())
		{
			$pin .= "P";
		}
		
		if(self::hasEmailSupport())
		{
			$pin .= "E";
		}
		
		$license = new MM_License();
		
		if($license->isValid())
		{
			$pin .= $license->getId();
			return $pin;
		}
		else
		{
			return "";
		}
	}
	
	public static function supportMenuItem($module)
	{
		$url = "http://support.membermouse.com/support";
		$moduleFound = false;
		
		switch($module)
		{
			case MM_MODULE_API:
				$url .= "/search?term=api";
				$moduleFound = true;
				break;
				
			case MM_MODULE_PUSH_NOTIFICATIONS:
				$url .= "/search?term=push+notifications";
				$moduleFound = true;
				break;
				
			case MM_MODULE_WORDPRESS_HOOKS:
				$url .= "/search?term=wordpress+hooks";
				$moduleFound = true;
				break;
				
			case MM_MODULE_PHP_INTERFACE:
				$url .= "/search?term=php+interface";
				$moduleFound = true;
				break;
				
			case MM_MODULE_PAYMENT_METHODS:
				$url .= "/search?term=payment+methods";
				$moduleFound = true;
				break;
				
			case MM_MODULE_TEST_DATA:
				$url .= "/search?term=test+data";
				$moduleFound = true;
				break;
				
			case MM_MODULE_CHECKOUT_OTHER_SETTINGS:
				$url .= "/search?term=checkout+settings";
				$moduleFound = true;
				break;
				
			case MM_MODULE_CANCELLATION_METHOD:
				$url .= "/search?term=cancellation+method";
				$moduleFound = true;
				break;
				
			case MM_MODULE_LIMELIGHT_PRODUCTS:
			case MM_MODULE_LIMELIGHT_SHIPPING_METHODS:
				$url .= "/search?term=lime+light";
				$moduleFound = true;
				break;
				
			case MM_MODULE_AFFILIATE_INTEGRATION:
				$url .= "/search?term=affiliate+integration";
				$moduleFound = true;
				break;
				
			case MM_MODULE_COMMISSION_PROFILES:
				$url .= "/search?term=commission+profiles";
				$moduleFound = true;
				break;
				
			case MM_MODULE_AFFILIATE_TRACKING:
				$url .= "/search?term=affiliate+tracking";
				$moduleFound = true;
				break;
				
			case MM_MODULE_EMAIL_INTEGRATION:
				$url .= "/search?term=email+integration";
				$moduleFound = true;
				break;
				
			case MM_EMAIL_TEMPLATES:
				$url .= "/search?term=email+templates";
				$moduleFound = true;
				break;
				
			case MM_MODULE_MEMBERSHIP_LEVELS:
				$url .= "/search?term=membership+levels";
				$moduleFound = true;
				break;
				
			case MM_MODULE_BUNDLES:
				$url .= "/search?term=bundles";
				$moduleFound = true;
				break;
				
			case MM_MODULE_PRODUCTS:
				$url .= "/search?term=products";
				$moduleFound = true;
				break;
				
			case MM_MODULE_COUPONS:
				$url .= "/search?term=coupons";
				$moduleFound = true;
				break;
				
			case MM_MODULE_CUSTOM_FIELDS:
				$url .= "/search?term=custom+fields";
				$moduleFound = true;
				break;
				
			case MM_MODULE_COUNTRIES:
				$url .= "/search?term=countries";
				$moduleFound = true;
				break;
				
			case MM_MODULE_SHIPPING:
				$url .= "/search?term=shipping+methods";
				$moduleFound = true;
				break;
				
			case MM_MODULE_FREE_MEMBER_FORM:
				$url .= "/search?term=free+member+webform";
				$moduleFound = true;
				break;
				
			case MM_MODULE_LOGIN_FORM:
				$url .= "/search?term=login+webform";
				$moduleFound = true;
				break;
				
			case MM_MODULE_LOGS:
				$url .= "/search?term=log";
				$moduleFound = true;
				break;
				
			case MM_MODULE_ACTIVITY_LOG:
			case MM_MODULE_MEMBER_DETAILS_ACTIVITY_LOG:
				$moduleFound = true;
				$url .= "/search?term=activity+log";
				break;
				
			case MM_MODULE_PAYPAL_IPN_LOG:
				$url .= "/search?term=paypal+ipn+log";
				$moduleFound = true;
				break;
				
			case MM_MODULE_EMPLOYEES:
				$url .= "/search?term=employees";
				$moduleFound = true;
				break;
				
			case MM_MODULE_DRIP_CONTENT_SCHEDULE:
				$url .= "/search?term=drip+content+schedule";
				$moduleFound = true;
				break;
			
			case MM_MODULE_MEMBER_DETAILS_GENERAL:
				$url .= "/search?term=member+details+general";
				$moduleFound = true;
				break;


			case MM_MODULE_MEMBER_DETAILS_ACCESS_RIGHTS:
				$url .= "/search?term=member+details+access+rights";
				$moduleFound = true;
				break;
			
			case MM_MODULE_MEMBER_DETAILS_SUBSCRIPTIONS:
				$url .= "/search?term=member+details+subscriptions";
				$moduleFound = true;
				break;
				
			case MM_MODULE_MEMBER_DETAILS_TRANSACTION_HISTORY:
				$url .= "/search?term=member+details+transaction+history";
				$moduleFound = true;
				break;
				
			case MM_MODULE_MEMBER_DETAILS_GIFT_HISTORY:
				$url .= "/search?term=member+details+gift+history";
				$moduleFound = true;
				break;
				
			case MM_MODULE_MEMBER_DETAILS_CUSTOM_FIELDS:
				$url .= "/search?term=member+details+custom+fields";
				$moduleFound = true;
				break;
				
			case MM_MODULE_IMPORT_WIZARD:
				$url .= "/search?term=import+wizard";
				$moduleFound = true;
				break;
				
			case MM_MODULE_USER_DEFINED_PAGES:
				$url .= "/search?term=user+defined+pages";
				$moduleFound = true;
				break;
				
			case MM_MODULE_SAFE_MODE:
				$url .= "/search?term=safe+mode";
				$moduleFound = true;
				break;
				
			case MM_MODULE_DUPLICATE_SUBSCRIPTION_TOOL:
				$url .= "/search?term=duplicate+subscriptions";
				$moduleFound = true;
				break;
				
			case MM_MODULE_EXTENSIONS:
				$url .= "/search?term=extensions";
				$moduleFound = true;
				break;
				
			case MM_MODULE_OTHER_SETTINGS:
				$url .= "/search?term=general+settings";
				$moduleFound = true;
				break;
				
			case MM_MODULE_VERSION_HISTORY:
			case MM_MODULE_REPAIR_MEMBERMOUSE:
			case MM_MODULE_REPAIR_INSTALL:
				break;
		}
		
		if(!$moduleFound)
		{
			$url = "http://support.membermouse.com/support/home/";
		}
		
		echo "<li class=\"dropdown right\">";
		echo "<a href=\"{$url}\" target=\"_blank\"><i class=\"fa fa-support\"></i> Need help?</a>";
		
		if(self::hasEmailSupport() || self::hasPhoneSupport())
		{
			echo "<ul>";
			
			echo "<li><a href=\"{$url}\" target=\"_blank\"><i class=\"fa fa-video-camera\"></i> Related Videos & Articles</a></li>";
				
			if(self::hasEmailSupport())
			{
				echo "<li><a href=\"".MM_ModuleUtils::getUrl(MM_MODULE_GENERAL_SETTINGS, MM_MODULE_SUPPORT)."\"><i class=\"fa fa-envelope\"></i> Contact Support</a></li>";
			}
			
			/*if(self::hasPhoneSupport())
			{
				echo "<li><a href=\"#\"><i class=\"fa fa-phone\"></i> (510) 564-7189</a></li>";
			}*/
			
			echo "</ul>";
		}
		
		echo "</li>";
	}
}
