/**
 * 
 * MemberMouse(TM) (http://www.membermouse.com)
 * (c) MemberMouse, LLC. All rights reserved.
 */
class MM_RepairCorePagesView extends MM_RBACAdminView
{
	public static $MM_JSACTION_REPAIR_CORE_PAGES = "repairCorePages";

	public function __construct()
	{
		parent::__construct();
	}
	
 	public function performAction($post) 
	{	
		$response = parent::performAction($post);
		
		if(!($response instanceof MM_Response))
		{
			switch($post[self::$MM_JSACTION]) 
			{
				case self::$MM_JSACTION_REPAIR_CORE_PAGES:
					return $this->repairCorePages($post);
					break;
				default:
					return new MM_Response($response,MM_Response::$SUCCESS,true);
			}
		}
		else 
		{
			return $response;
		}
	}
	
	
	protected function repairCorePages($post)
	{
		if(isset($post["corePageIds"]) && !empty($post["corePageIds"])) 
		{
			global $wpdb;
			
			$corePageIds = explode(",", $post["corePageIds"]);
			$resultMsg = "";
			
			foreach($corePageIds as $corePageId)
			{
				$sql = "SELECT * FROM ".MM_TABLE_CORE_PAGES." WHERE id = '{$corePageId}';";
					
				$row = $wpdb->get_row($sql);
				
				if($row)
				{
					$deleteSql = "DELETE FROM ".MM_TABLE_CORE_PAGES." WHERE id = '{$corePageId}' LIMIT 1;";
					$wpdb->query($deleteSql);
					
					$resultMsg .= MM_CorePageType::getCorePageName($row->core_page_type_id)."\n";
				}
			}
			
			// reinstall core pages
			$installer = new MM_Install();
			$installer->setupCorePages();
			
			//rebuild core page cache
			MM_CorePageEngine::createCorePageCache();
			
			return new MM_Response("The following default core pages have been reinstalled:\n{$resultMsg}",MM_Response::$SUCCESS,true);
		}
		
	 	return new MM_Response("No core page IDs received",MM_Response::$SUCCESS,true);		 	
	}
	
}
